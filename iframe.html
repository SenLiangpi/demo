<!--
 * @Author: Pi Patle
 * @Email: pisenliang@gmail.com
 * @Github: https://github.com/SenLiangpi
 * @Website: https://senliangpi.github.io/blog/#/
 * @Date: 2021-01-19 10:10:06
 * @LastEditors: Pi Patle
 * @LastEditTime: 2022-01-29 15:17:56
-->
<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <title>iframe 跨域交互测试</title>
  <style>
  </style>
</head>

<body>
  <div id="iframe"></div>
</body>
<script>
/**
 * @description: token
 * @param { get: 'token'}, '*'
 * @return { get_name: 'token',data: token }
 */
window.parent.postMessage( { get: 'token'}, '*');

/**
 * @description: accountId
 * @param { get: 'accountId'}, '*'
 * @return { get_name: 'accountId',data: accountId }
 */
 window.parent.postMessage( { get: 'accountId'}, '*');

 /**
 * @description: displayName
 * @param { get: 'displayName'}, '*'
 * @return { get_name: 'displayName',data: displayName }
 */
window.parent.postMessage( { get: 'displayName'}, '*');

/**
 * @description: mobile
 * @param { get: 'mobile'}, '*'
 * @return { get_name: 'mobile',data: mobile }
 */
 window.parent.postMessage( { get: 'mobile'}, '*');

 /**
  * @description: orgCode
  * @param { get: 'orgCode'}, '*'
  * @return { get_name: 'orgCode',data: orgCode }
  */
window.parent.postMessage( { get: 'orgCode'}, '*');

 /**
  * @description: token_invalidation token失效
  * @param { get: 'token_invalidation'}, '*'
  * @return
  */
window.parent.postMessage( { get: 'token_invalidation'}, '*');

/**
* @description: authority 权限 code list
* @param { get: 'authority'}, '*'
* @return { get_name: 'authority',data: authority Set }
*/
window.parent.postMessage( { get: 'authority'}, '*');

  /**
* @description: path 获取跳转地址
* @param { get: 'path'}, '*'
* @return
*/
 window.parent.postMessage( { get: 'path'}, '*');

window.addEventListener("message", function (data){
  console.log(data.data)
  const iframeDom = document.getElementById('iframe');
  iframeDom.innerHTML = data.data.get_name;
  console.log(data);
}, false);


/**
 * @description: 监听器 统一接收请求返回值
 * @param {*}
 * @return {*}
 */
// window.addEventListener("message", function (data){
//   //返回的数据
//   const result = data.data.get_name;
// }, false);


</script>

</html>